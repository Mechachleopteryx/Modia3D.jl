<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Contact Detection · Modia3D</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Modia3D</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../man/GettingStarted.html">Getting Started</a></li><li><a class="toctext" href="../man/Examples.html">Examples</a></li><li><a class="toctext" href="../man/Materials.html">Materials</a></li><li><a class="toctext" href="../man/CollisionHandling.html">Collision Handling</a></li><li><a class="toctext" href="../man/Plans.html">Plans</a></li></ul></li><li><span class="toctext">Library</span><ul><li><a class="toctext" href="../lib/Composition.html">Composition</a></li><li><a class="toctext" href="../lib/Graphics.html">Graphics</a></li><li><a class="toctext" href="../lib/Solids.html">Solids</a></li><li><a class="toctext" href="../lib/ForceElements.html">ForceElements</a></li><li><a class="toctext" href="../lib/Basics.html">Basics</a></li></ul></li><li><span class="toctext">Internal</span><ul><li class="current"><a class="toctext" href="ContactDetection.html">Contact Detection</a><ul class="internal"><li><a class="toctext" href="#Distances-1">Distances</a></li><li><a class="toctext" href="#Crossing-functions-1">Crossing functions</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Internal</li><li><a href="ContactDetection.html">Contact Detection</a></li></ul><a class="edit-page" href="https://github.com//blob/master/docs/src/internal/ContactDetection.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Contact Detection</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Contact-Detection-1" href="#Contact-Detection-1">Contact Detection</a></h1><h2><a class="nav-anchor" id="Distances-1" href="#Distances-1">Distances</a></h2><p>In <code>scene.options.contactDetection</code> (file <code>Modia3D/src/contactDetection/ContactDectionMPR_handler.jl</code>) information about the contact situation is stored in an instance of <a href="../lib/Composition.html#Modia3D.Composition.ContactDetectionMPR_handler"><code>Modia3D.Composition.ContactDetectionMPR_handler</code></a>.</p><p>The <em>distance</em> between two objects is defined by two variables:</p><p><strong>distanceOrg</strong></p><p>The original distance which is the distance between two objects computed either in the narrow phase or in an approximate way in the broad phase (= distance between Axis Aligned Bounding Boxes). If <code>distanceOrg &lt; 0</code>, then the two objects are penetrating each other.</p><p><strong>distanceWithHysteresis</strong></p><p>The distance reported to the integrator as zero crossing function. If a zero crossing occurs (the value is changing from positive to negative or from negative to positive), an <em>event</em> is triggered and the time instant of the zero crossing is detected up to a certain precision. <code>distanceWithHysteresis</code> is a slightly modified value of <code>distanceOrg</code> in order to cope with numerical inaccuracies and in order to guarantee that this value is not identical to zero when restarting from the event (otherwise the integrator would trigger an error, because it would not be able to detect a zero crossing in the future). At an <em>event instant</em> (including initialization), the following flag is set and keeps its value until the next event (<code>zEps = 1e-8</code>):</p><pre><code class="language-none">contact = distanceOrg &lt; -zEps</code></pre><p>Whenever a zero crossing function computation is required by the integrator, the following value is provided to the integrator:</p><pre><code class="language-none">distanceWithHysteresis = contact ? distanceOrg : distanceOrg + 2*zEps</code></pre><p>The result is the following:</p><ul><li><p>At initialization, <code>contact = false</code> if <code>distanceOrg &gt;= -zEps</code>. Therefore, if two objects are touching each other or are slightly penetrating each other (e.g. <code>distanceOrg = -1e-14</code>), then this is not treated as contacting. Otherwise, <code>contact = true</code>.</p></li><li><p>During simulation, an event is triggered if</p><ul><li><code>distanceOrg</code> becomes smaller as <code>-2*zEps</code>, if <code>contact = false</code>.</li><li><code>distanceOrg</code> becomes larger as zero if <code>contact = true</code>.</li></ul></li></ul><p>By this formulation it is guaranteed that <code>distanceWithHysteresis</code> is not identical to zero when starting after initialization or restarting after an event.</p><h2><a class="nav-anchor" id="Crossing-functions-1" href="#Crossing-functions-1">Crossing functions</a></h2><p>Modia3D uses the dictionary <code>contactDict</code> to keep track of the contact situation. Every pair of objects is identified by a unique Integer value called <em>PairID</em> that is used as key in <code>conctactDict</code>. A dictionary value is an instance of <a href="../lib/Composition.html#Modia3D.Composition.ContactPair"><code>Modia3D.Composition.ContactPair</code></a></p><p>At an event instant, dictionary <code>contactDict</code> is emptied and all object pairs are stored newly in <code>contactDict</code> that have <code>distanceWithHysteresis &lt; 0</code>. Between events, contact forces/torques are only applied on object pairs that are in this dictionary.</p><p>The following functions are used as zero crossing functions:</p><ul><li><span>$z_1(t)$</span>: The maximum <code>distanceWithHysteresis</code> of all object pairs that are in <code>contactDict</code>.</li><li><span>$z_2(t)$</span>: The minimum <code>distanceWithHysteresis</code> of all object pairs that are <strong>not</strong> in <code>contactDict</code>.</li></ul><p>As a result <span>$z_1$</span> monitors if an object pair that has been in contact, looses contact, so <code>distanceWithHysteresis</code> becomes greater than zero, and <span>$z_2$</span> monitors if an object pair that has not been in contact, starts to penetrate each other, so <code>distanceWithHysteresis</code> becomes less than zero,</p><p>Whenever the integrator requires the values of the zero crossing functions, the values of <span>$z_1, z_2$</span> are newly computed. At all other time instants (e.g. communication points), only the distances of the object pairs are computed that are in dictionary <code>contactDict</code>, because these distances are used to compute the contact forces and torques. Distances of object pairs that are not in contact to each other are not computed at these time instant.</p><p>Whenever contact starts for an object pair the normal contact velocity is stored in the value (of type <a href="../lib/Composition.html#Modia3D.Composition.ContactPair"><code>Modia3D.Composition.ContactPair</code></a>) of the dictionary. When a contact pair was already in contact at an event, it is necessary to utilize the normal contact velocity from the previous event also at the actual event. In order that this is possible, a second dictionary <code>lastContactDict</code> is used: Once <code>contactDict</code> is constructed at an event, a copy is stored in <code>lastContactDict</code>. At the next event, a new <code>contactDict</code> is constructed. Whenever an object pair is included in <code>contactDict</code> that is also present in <code>lastContactDict</code>, then the normal contact velocity stored in <code>lastContactDict</code> is utilized.</p><footer><hr/><a class="previous" href="../lib/Basics.html"><span class="direction">Previous</span><span class="title">Basics</span></a></footer></article></body></html>
